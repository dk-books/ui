    name: Github Pages CI

    on:
     # Trigger the workflow every time you push to the `main` branch
      push:
        branches: [ main ]
      # Allows you to run this workflow manually from the Actions tab on GitHub.
      workflow_dispatch:
      
      # Allow this job to clone the repo and create a page deployment
    permissions:
      contents: read
      pages: write
      id-token: write

    jobs:
      publish:
        runs-on: ubuntu-latest
        permissions:
          contents: read
          packages: write
          pages: write
          id-token: write
        steps:
          - name: Checkout
            uses: actions/checkout@v3

          - name: Setup Node.js with GitHub Package Registry
            uses: actions/setup-node@v3
            with:
              node-version: 16
              registry-url: "https://npm.pkg.github.com"
              scope: "@dk-books"
          - name: Install modules
            run: npm ci
          - name: Build
            run: npm run build

          - name: Publish
            run: npm run release -- --gh-pages
            env:
              NODE_AUTH_TOKEN: ${{ secrets.GPR_ACCESS_TOKEN_APRIL_2023 }}

      deploy:
        environment:
          name: github-pages
          url: ${{ steps.deployment.outputs.page_url }}
        runs-on: ubuntu-latest
        needs: build
        steps:
          - name: Deploy to GitHub Pages
            id: deployment
            uses: actions/deploy-pages@v1